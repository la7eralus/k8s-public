version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:BwJMHJWKZKlbd7+7sBfcN29DFugaauw=,iv:1ykIFaZfJOVYqjgezL0goKp1Ix6239RVli/QsYfDh3E=,tag:iKkTxfcb5x5hUBVADQX8rA==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:PLWG7hp23c3SOBtpmyg6z+h3bkBIAqQ82eDa5dGCbqFeqettfuvRqgXn4j7oPPXK2z2lKykJw2W7Zk5DheNmcuk6C9WoGdBCcvFy8wyqM1entde2fZeqbCC2BoU08PMboQdYngAZVoAfBtDCP/p83AgrOXn4L7/uIFobJYrmcP7tZnMDW/HeVWaKYRmaOZIFFuw0kS4gG7NbtNEGPyluaSU3ZWQ8MpeM5frJ+Vx13Gw1IDp8kJRNvNeG/OWEpFJiCOxWN/ILtz6uKMtA+VxvZCaW3lYo+Lz4g+hL2InHcKivmSyLPtaRqKIbHu+67MT60IKDxvC1qb8R7HRAQq6ibdN704G8ENMXhKdfVmpoEbny4LZJoPxoG2EHBhEJe+EWTCS+lBRA9CUEJqbEjbbuC+i895OrgXKY3kpCghqo50WO1Hwr/aSA4oKk0UAEDikB3JOSZvhTIxTTVaaagj7BLsagAMp3M8085ZGAIyc7hLWVOlpHe6/Ey39LlutPrgB9h2cpgmHsMFOzGLMpN3Fkw2rWk0Hf7BFO4maUBC3qbntHaNg1HmBgj87hVl+gitEuqPRNaKUrJGxu97mohBac8OA8kae27xDrddKz2GTV4Jcg/syIdSFW6ZZRkeO0AHE3QV0axqvIOZuTovTwH33GgdIbtp/YYmkZfGiS1FOWGauX2IN1FBIuyf9nKJbs01yGrJzVnOBlcA+M/HJc19XxyEQdVTGvRx9GnrU+PRYw0xiZiLkt6Uw1zZnXMdSEkdI7G+/X7Ace6BsU+2zD1GBjjwKb7YNhDiGJ/6iy09KgQvkfUPAfD8OXARWgrzTbSklYZUJ4z3gukixEcUze4dZBBa5GitxJFsKctbkxgBJlHEyk04DS,iv:VZW+63OPjwkVE/Gar2df9ePk5t03LT1REsidTS8X0h8=,tag:JWuC3tj2wLGJI2RrA2nzkQ==,type:str]
        key: ENC[AES256_GCM,data:9l619+7NjKhJcN9qOIOmG6HTjKiFLMU7sPL+9hlgSc01pa6jt1NRHNiF61l2PSEG654U6hWL9aILuf6nlRSUA2XlxgklCJ3PAUcr1cwpSwKrXJm9mwXcayzacUspxuQGb2GvTjXgQKSSc8Cswvo1oi/9TFWiR5BFIQojkCG4Lx7fPX+L8yjbca7UJdva+2VIQOAQRVkgeAHSXICGBhdIPI4I6wUip87AGAobz10B/wPhqBWn,iv:rqbYHP6S2NPefgAueCKc2wyUWlo7KlIZg1aIgY42/BY=,tag:YjJLMtPQaRFnbJeWyavClw==,type:str]
    certSANs: []
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.28.3
        defaultRuntimeSeccompProfileEnabled: true
        disableManifestsDirectory: true
        extraArgs:
            rotate-server-certificates: true
        nodeIP:
            validSubnets:
                - 192.168.4.0/24
        extraMounts:
            - destination: /var/mnt/extra
              type: bind
              source: /var/mnt/extra
              options:
                - rbind
                - rshared
                - rw
    network:
        hostname: talos
        interfaces:
            - deviceSelector:
                busPath: 0*
              dhcp: true
              vip:
                ip: 192.168.4.5
        nameservers:
            - 1.1.1.1
            - 8.8.8.8
    install:
        disk: /dev/sda
        #Extensions: qemu-guest-agent, tailscale, util-linux-tools
        #Boot Iso: https://factory.talos.dev/image/7d0c9bb43d29c3a66af593485d6d95ae14f241c90678c9cc05a4cf99d928ec1b/v1.6.1/metal-amd64.iso
        image: factory.talos.dev/installer/7d0c9bb43d29c3a66af593485d6d95ae14f241c90678c9cc05a4cf99d928ec1b:v1.6.1
        wipe: true
        diskSelector:
            busPath: /pci0000:00/0000:00:05.0/0000:01:01.0/*
    disks:
        - device: /dev/sdb
          partitions:
            - mountpoint: /var/mnt/extra
    registries: {}
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
    time:
        servers:
            - 192.168.4.1
    files:
        - content: ENC[AES256_GCM,data:Ej1hTwB2D6kQt9b0DA7mvxBU1RGVfZ7vWBqEZPXLPhBne1fCJIu2pKKVTzxBcOSQSJPtYi3e56DU3FENolovwGvtL1pLe9phbf4ySU/s2q2mjLkoOb3oR96qFl8NY8GFWq9BVeIpcyJ+BBH2mktabxS0CZycOjPkTxAq78xze0Ht4GywXdjT7m/pJpwquiW6bXTGwLJjfEntwwOVtbosUqNeIKQTLRB7rLJNMZP6dw==,iv:43kz3PF2EKLoS8pnjTyBIZJixHLve7tDZZcfOYYnniQ=,tag:npjCRBpO0O4TOE6Jnb+NNw==,type:str]
          permissions: 420
          path: /var/etc/tailscale/auth.env
          op: create
cluster:
    id: ENC[AES256_GCM,data:n67oTVwGXDnv1hLQhifcHS/DxJVMrKHTIUu8mnX8Z0drCo1IpCKWzaACOTE=,iv:BQ/x5uGhEkGbm1ca33YmJP7XbL/QTlupuv4eMtApIWA=,tag:PKq7kAGg2khrEYgRKCRjTw==,type:str]
    secret: ENC[AES256_GCM,data:PokuqeAnGZaGBH51JZ6vOevNHT2+/Q7se1n1QXmPhwwl65MTGMMZDIzIkHg=,iv:fEBRbg+DIKnnC3wBFmDZpEY7RExi3fsRlVDcMkN0cfE=,tag:30l8bzZDWhkkwJ+n5hZJXg==,type:str]
    controlPlane:
        endpoint: https://talos.s3rv.dev:6443
    clusterName: talos-proxmox
    network:
        dnsDomain: talos.s3rv.dev
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    token: ENC[AES256_GCM,data:qxb4vrNkepnI1NRIi2zJKVA4eOG7hRU=,iv:xXCu3jmI+gNpqOqnyogvrkibHrgipO6tm1RNjj6dgcA=,tag:KClsy76xeObmslJM6wYLFw==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:wVCTCnY+sYQU5zIYAUlDFSU5y+sbqZBjxxFH3lVlKgtwKUTFBV77f77+KD0=,iv:c57FEl3IRiJO6Qy2RJh47Exs6F0FTEwhEhi6AyF04a4=,tag:L/IN4rS0xZi8rrKXr6vQEQ==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:hl6OziPe6MEWiErnTbqH06RhHO92sCJwJGH/ag5z+Cb3Oabh5IEj6N1veyFHesVmKiPvcbyZ2W9h4saC/jFSZVol/iUH1RDrML3WWdPQIpMlTrBi+o+QXulYJmPfKsiDf1wnhcjO9BOWBB32z4qM03iJu4DiwsQ0Yx9WE2NDca2UTJCtsB5aEA5DqqYo8ObLfyAaW4W/F+T5rRRx6XyHikp8jfALcb3BADWhVXRzvWm/ZJoQ/+gktXO/JU9omB3TKQWFxgO4WUzafXMgiOrXfldsBIsBJ0pxa4kDC2R622+JxE1daMjfwH0eTqosOQ6U1yBNtn1mvbsGw++ZMfKAokg25CymQQNwcUT1f15doPy/Z6mV8HQimH7RADdaYN0HCalUJsrGI00YBjNh77Og5cO14uqRzUmtrVct6CGc5N8TSzDK1FBF58q/thQ3OPRns3ndSptsL+GEn6uPikAhV4ihSnbTZO9HTRsoA9ms4EaaHhhEXjLDTQdGnOIimE9giZMsjhzSTo8pW65wGkwB/ihUOpmz727TYeAyiSu/ylgAg15LqVCgb/n22wcVj6PidaV96UI4kt9qEGLh7eoZ1q/XysDA1pqwcEhTfkPWxJyBimKHwCMpNqoabKc3cOZklj/aYv6M/UzUHzuldjBe4BkIwBYIlV18RbG+KlFtuIlbCXfGpHRcpp7IdyCkC0Z70BisXfRI2gYTOCcdIpfbLEJPvgrGEWkghSC9YP9/wIHS6PWjKNVuK8BaHlxUfMA0CCI7sAXjTDweWlFI0qW5e6/7KBfvixMIL81/3oUhIZQ6QVHxjnW9MlXhjVV2cGZR3SbHs50YQMrMRCNiE8o41zPt9dYT86q1f57o/88uR9F/Ruf6YlZ+mmRoO8KhPDpfboBiV5uYoLq+g07KtYULgmwcT3XDKfe2219R95BCJj7QlePF+SOe5CVCEcz6M7TiNbh3J4dWqsDYDgT/1byyGb1zX/nMHlBiNhM7ojz4QiLb3Ls4mGmofa0b6vsSsD5PcbUZgCJAedYwrsl8GgRpxdBx1TIorriTn0JZUA==,iv:7igplFviB91fhd6ui7GLF07zJ6C/K02KrmB7zhDlCNQ=,tag:qTSOFwkStFSSg81KlmFDuQ==,type:str]
        key: ENC[AES256_GCM,data:cdS8VJgAGPyPu2LJ3an5hMXQjgKrfNhUVM3TP48hv3aAGQ9jv3SyVVVAFtM6bE1COMdT4vriuMYhYpL5mBC7eB0KzGV/bm6n2+TFIDbbIOxAIYqsd7LWNGapvgwKX/rU+4zOhpEMs00ms36TT3h6n8smK71HjD8Fm8li6PN39RXg4D2nukZKK5I44wSvhg+vR87iDu94f8/ljLLcvy89Ioivf7f/qSwCi7a3jy0wgXNSSyahvtS8Mvpk4ylfb0sTAkfcdqkv8dPNRVhALUgbULPMpupDc1zRXl7Lo7o2HRsgFGqhh9EXQVaPAJRIG/G262DRFkhdJwBWncIjvH1KsDXNkjJQ4U5ijngNI2NBKsRRZ28rGX1Dh0TbYfn8WqEZHccJ4XirN+xGDy9FIFtjqA==,iv:tUaO8YWnlQ7utnPQxmn57sWiw09iYDU9iBSghCGIQDg=,tag:5Az1C9HTk+gAGjmy6f2hsg==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:A9njyzHfWXjDQO+KjuS0yxeAePMiTHR0eOuyPxlTzXKg3aHnIUsbcRQ486dDGqVQJXAPIUqY64MEoixI9u6EW2WkGHpRvD5jC5FH4Gx0zo0EHAzKY9vyWfPPJ2wUyQlSAlAcae67wx8D2/86F57sSabwgXrvPr1KvZVdD2zAZSJwECwt8SN0W8IE9vfTzmsC02N1NAbLjuIFWHzuK4XMe84b0cuLlR8X3vEl0iMe/PMGWyIzVvAwUFYizC2yJBddtSWLI/l2RQ6ttGoScK1JlUB/8xq2vvZQjRgQSUj2xpREEcKDhoVxGtql6AiHQ2Z9OIo1/J4CnEut/kNwOqnvc0qAdVeCYROBwHUZ+aHHacI3hHYXSHyXsrvfMJvEPuhyKu+Tos4AKMxpkCizqj9Q1v4IJ4ayblKwWN4sLaDfdrxMBH3VQQsMEoXjO397wCx9GE7jbxbaOyZYkuaphNnVVPViKllYVku4TjIY8OPjgCcIeTo9XXMcp8iqJ8Olwq0Ik59VipYRPT8+fpJyqjVM9GB4ogJY9GBToQCYogZIG3m1ea7PH8ldrkTdGDTmSlB+cFLPKZmKxofaBDdLnYgd457CM2ead0vABzJOWFLWqweYBVyXS9XCgyYqmCdXi7X5jdYdmdoRD7QnYoLg9OexescedtDqJF5Uv58VCvbzHNeAmZhCFNXbHb+om9A1Kr1Ct+9+9QnGqmEBN3yBzwuRvbKUwEqU8AjG2/yDmrfexypVZb50RBlAPfozYFBVodBr6gmbFs9/6E0A5YALK5tW72Dpm//9kiOSdOfJi1A7yJPU6wjutaSCbr/sqv8zhExDbH7ejXIxkzJ09IbDRwLgfgGi6Hi5pX5uC+nWfr4eJFsNoHdaB5xYsmlsbIeRwYUdaiIaIfRUpsbLVvD78Lo78SchR63eLmd385n9Cjm4hyrBR/szz6LRQDTQRkTFJZ2t,iv:x2KZLZaubRZgkcWEorfBe4tHfixOuOVH8GdhMp73Ai0=,tag:sHb24AAFiMg7XC5nr8zBMw==,type:str]
        key: ENC[AES256_GCM,data:MtMVOj/xVL/4KrN5rxehvQp3+TTRgI603nhaIDVlx2KZ60UMBbecBGNwTp0mS0vn2wxBe2JpDZNcAY8gKEkJpI8h2TXoh3ioMqaUg5gU4uDmSGV1Uuzyj8g/oiXrlIkArsm3bXB8KEioatGCa3tURiRK7nzd1QFmE1G2ny2zroQla6udZjqMqnsfddQhdX+HIeXmXeEA35qarvikLu6QiC0/GsuXPMkoRL/AVusStVPc96h5eGDtHCmffXxq2e7UYMWIvxhNmA8qD4haelY4PBPEUrHr+gSJ4DSrXoyoJPUVyXV2moz2wmhWueUcaKJjMxPdMlfYaggG0qy6LyzPZ0asXBNnlWoeMHlBKKbrUOnDZ+n4a5BmE0/GiY8j+jiGrwW4b8778gf1+dktnIeoyQ==,iv:C7yElOB/uA4x/dijBYrD9rhSPRNKGYn9dlb8+kxhHJ4=,tag:cDVlM2w7prM3t3z/ydqNKw==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:x5MNhDscb28cfzXm8LjR3QC9J+s/oL/sFJDnWaHJwQtdG2t7BFD4KQl+j8tNNtfyg85yEx5fLf9exRTLEGPRHMLpevCo0IN7spjUl898PMAF7x4Q56a4aCvAl78gl9bM4r4ybs8lBQMIknAYsKJ6Ex7zSEN6anMsdGG8YXuxUfaCWkx7/3z7U19MWuXoMRwd7GaaxtJBwLWkwXe7dQDGM5vN06QM9qx+Vlp6OIHVOEqYicpO8wohFP8Sh/ENOaF9hnTXXdTFx65QvGtkLfijOBQgZsFhyiU7tYeJ6cmf10t+qRa6Po5oBt8u/2FFkwEiPyBjW5SdDAPKwGDIkY9XHWY8xLMdFiJRsoe7Gw1PQwfWwMD1NIhkwSqluN3M7/ivFIlHGstpWWfqyfjoqykr1g==,iv:6htPcXTToH3a+e8nbhh/FtcznK8EujbVmDppwDsX0sU=,tag:e/CB1ne/BBG1eW9iM8rSjA==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.28.3
        certSANs:
            - 192.168.4.5
            - talos.s3rv.dev
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: baseline
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: baseline
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: None
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.28.3
    proxy:
        image: registry.k8s.io/kube-proxy:v1.28.3
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.28.3
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: true
            service: {}
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:UMilb2XMUK0XbExc65hdpgKXlr+DHPJl1ut1c1IvBPFVsfPtQmYx9Tuw6nNNciZxJvZ8d9eKBB4a4GYqSdNZcOHoR5tOqqJiS/f2kyiV4aHDFuvZPvSjlbcZE8XaJseqQDo8c5AXHwjXRdlektfwh7wX1Y3YciYQAyyc4VIiFPnS95ZfNWStcuNQaTyjsatALZ+2tlKc3E7tFguxrHhSjnRbrIsEdSsjTPHpllpDTuh6u/Z9wMXBNGAjbgfkZp7MFabz/mhc9JE1ayTYgmHoHI3Yvto5kX/cTQiMytevF3XJuLge2xqvmyzF7laGKQ2QrAPHLkI62FVVWfbbW6L+Ap6L4KAgMFzKdPxwNjfJoGX2UQvIA/fmUyk+wZtLMgHLFVyoajb/9CsBqENA1xv4IqNRt5+Re0E+39dSrrj/kmfnY3Gw+JC6dbMqmhAwqfs+QCBzSLL/WsCW5ewe9zaawRQBaxIBUnPV9ejsTJjNlx3WngQxEpnNUxinegFPGFpBXxA4Y+7kLSx4rSgTALGJu+PQC5P2JeCRioxN+WMbjcQTX6jUGEOTLIdfrcfCRw6dIOGrbz1s/k2K5ICj8RrC0ExeMJuDr/slduWKHDmsQsVoTHQujczCp9n3gjHmoYBytyWt+r4CKKwuKuyzi5m4WPgf8bIOyeUoui7fc2bpatax9DysZ532TL67Hvk8wuC6c4AonzTGTNtCmoqHT2ZeZjx+DNu8O0L64NQIchdbrO+SMITcwhqfIAoSSYkRAysqwjERuBUP2l3ZXSyORv2K0R2xP/GAqUTzfXBHgSB4pazvfdGCThq3T9rwOqnvlorudClFVGcDCPCOEY8W6ljyZxZKgaFhtdxwmn49V1gU/dlUtn6DqNLpo9VwemHj0BCQ+8Na+uLkWr2F+ChfpQntzFpdntGehm5dmvoLzTW+AS1Z4JA03I99cqs+dac/56GbRryYYVitalqz0q5olQT0ImGCp+k6TY/wwu3LBCVcO/28TicEpr4HDARnjY24LgYmF23ZhQ==,iv:wztZ5rdZwqRDTRtuaAY8fpUuTJ0q7T5dGx8nZSWqvoI=,tag:9Of2B02uD0cv9+sYd8TDqA==,type:str]
            key: ENC[AES256_GCM,data:wmz892bFEh3RGm/RDTcXThtlCYQKezNgaXF3z6zYkIZ7zCfDYaxiMYFjkbx/gw2K7sH3ym7pYXm1IHeDAeH6oqSHBYd6v67SXHbiHd8Cwwmofs1rTB29OkIUpNnCGcoO0fsrr5J3WEE03ui1flDZl0cLGIaZ1cUOQ4F4FmEmmCLQLtOIFpghdUL+Zn7vos2WhcyxZefojFrDqoAjRUYbtxzMM4mo8oGrOSwl+CRR6/V5RdG8McNqhUUSth4MxGQYDfhEe3+2r3RU4EoJ8cULOTt+lVsmAFQ2c+uOzzv+SraGM3enyoodXuLizbcjwrVuk1z56qoPkbrirj6LtKQiM1wvJ+QSBUlIRINBI3dWzGxks0wIsKX0FQ91+s5YE5QAee0Oc27iCEBqQ5rpS151Ug==,iv:hBrmQZjfnSIM2uFt59o4RzyhBOWx7Vk9wqYak0OwsOI=,tag:WDh+HI1KnEF1VFXfF1gtjQ==,type:str]
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
    allowSchedulingOnControlPlanes: true
    inlineManifests:
        - name: default-sc
          contents: |-
            apiVersion: storage.k8s.io/v1
            kind: StorageClass
            metadata:
              name: local-static
              annotations:
                storageclass.kubernetes.io/is-default-class: "true"
            provisioner: kubernetes.io/no-provisioner
            volumeBindingMode: WaitForFirstConsumer
            reclaimPolicy: Retain
            allowVolumeExpansion: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xjszg77q3ddquyvgh7scmwh27hk4ns0uef5w4y5feq2nnc0v8y4smgdan7
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBtRUxETmdmYXlyR0RwTWJa
            UzRVcE9Ic1hUOW5jZ1BjYm9hakJCWTNCb2o4Citjd2N1MW9Wcjd0cWVyN2h3ZnBR
            WVArUHB6ejNnOUw0ektCMmkvQUcxY00KLS0tIHhuRjFFTlcyb0tQVTUrWXRxSDVX
            K1d6NFdsTVZrbWk1Q003bXJFUlZtUGMKZo42pT9puvCTGoh2fKdX+aBID5UNFAKN
            kczqhr5GUtd0DLdXxZlvCIZONg31JujgeGA1pOXiItvLkX0xxFPQPw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-01-11T19:23:33Z"
    mac: ENC[AES256_GCM,data:8dVjIhKqGLnNoDeMqXPY1is0+IvTIiAm3bCpkKyn4xbSpi/Kz5Ivpi5vmqa5pbGHPTS9GrZOSl1jwadPCJ5XbItuPeYl1tcsER8PsIhsjPxlBR8DOgT6RPprOtxTDgKByJRPmx8SsYGnlzeM4dpmebyGUtDniCa+cBHmRYtF6hs=,iv:W4auD+dmgATw7cIT7bKu50dSw7nXPj7EiHL1ZFRtY3E=,tag:ShgQSLbFQyNXe0H2qJYCjA==,type:str]
    pgp: []
    encrypted_regex: ^(content|tls.crt|tls.key|crt|key|secret|secretboxEncryptionSecret|token|id|ca|data)$
    version: 3.8.1
