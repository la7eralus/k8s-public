version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: ENC[AES256_GCM,data:R5EvFP5lD3lV17bq1qDj0FCt4J/1fBA=,iv:+MlMdVy0OYzpjk02km7kEQDXRwNm0co5As79Als4c4A=,tag:QgmqZvvE+rOqlvDk0Qki0g==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:Z93ivBgGk7UnOm9PDrq2JucKtR4bpBbX+/m5QNrffL5xAstOWiHeuXAMUY+KOVDyOPqW3h34Ab9V7DF1+NskCvAeeQFvB5THbd9SqwaGlHi31gkNWTSodoqpRY3ODAYVEUlNtbIO3rJkTFwbVt8CjEiJ96Zzz4E12zoXv1ua2pJdd1E8genuV2KgDSrCOUU0GCfgrIRwWm8Q9dGFUP0nRbf7IXs6RwOOjdZwAvDJ23gWSE9yNhuh3qEw9rnRp9dITTUGTnclKEfXRaORkI2xsSH+FGbPPhz81p3fteV4e9nglkLf9DecF+5iIWrj0Gk66VAGhJGgLNPAkWc15vLrasp94FLx1x0feTZj0oZdSnvTlN52zdzDu1pMs5Bb6h86EFQKN3q7PIeLn+0EVKgiDDZDFVLglXFxao2Gp6HbSxwz2njb9hG0Tmj14h77BO55m5W+pIdEKE+V+YvrjvQ7QhCHYUGV9hq2+CJ1EQnnGWd0ec/mn5JY4C7O3tnVCUwdnqf67I5TVJRCNXSB7WBT9vOidiSBMshOjNzCeW3wA/eKPGuWLQngaepOeWVUqwNzN7y3A+u295TlAcHSkkeHJKDhUb+GqV1limm+oFTKDKyKgcdy/Fo0vqjTsKhHfgTMqd0kcDW7QH8FJW/zJnssQcTD5NFhKgtrnTkVaEJy3A2v430gl+PRLWZmY+hW32hdyomn4szkbtlowWBDlU3Bs8dporL2vUXURsR+2/NeD/dWHlMAqWhOrPoPcRYpBjiV0sB43B4kV8ZTdmxbRcOwFdY4911wyrnHppzMQIg213v8gz7SR6JCECqFW4kOrQcggsH0rvOfpNc1J3u58zXfq5TQlRZaCCI35RXm+17aMtN7nnDi,iv:6KhF0ZBAhnF0JUXGaGtCsTQPTXAlTPcpMcOC3sBhjaY=,tag:EJED1XdKwBOMBmUUUfgwTA==,type:str]
        key: ENC[AES256_GCM,data:MP/2axxXphabd8SnCSiaBYJldUZSxjbhoRZhUCPpW7bhNB94E19wizELVIFDhqmywQ/lmT7U+qfPC8/Gs1TzOKVf+lZQt48jcOCB/ur/zdFcxrGFFW4F9hIP6rityL8hG/2boB1g6cXQkpIOCuimRma3S3bfvsLqPKG7ZB7Xqq3RQFFQTYV1smnNtX947VsojaVN59pKsh55cmlJr0UeyMsGTDy/VwuxgwN0X721PgPTvFKP,iv:Zqsds+PYBEk+7TJPUGehFE7NrMKe1CBT465MNVLX6Dc=,tag:BZPyTpYMTb+MqzfiBro89g==,type:str]
    certSANs: []
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.29.0
        defaultRuntimeSeccompProfileEnabled: true
        disableManifestsDirectory: true
        extraArgs:
            #for metrics-server
            rotate-server-certificates: true
        nodeIP:
            validSubnets:
                - 192.168.4.0/24
    network:
        hostname: talos-controlplane
        interfaces:
            - deviceSelector:
                busPath: 0*
              dhcp: true
              vip:
                ip: 192.168.4.5
        nameservers:
            - 1.1.1.1
            - 8.8.8.8
    install:
        disk: /dev/sda
        #siderolabs/iscsi-tools, siderolabs/qemu-guest-agent, siderolabs/tailscale, siderolabs/util-linux-tools
        #iso: https://factory.talos.dev/image/077514df2c1b6436460bc60faabc976687b16193b8a1290fda4366c69024fec2/v1.6.3/metal-amd64.iso
        image: factory.talos.dev/installer/077514df2c1b6436460bc60faabc976687b16193b8a1290fda4366c69024fec2:v1.6.3
        wipe: true
        diskSelector:
            busPath: /pci0000:00/0000:00:05.0/0000:01:01.0/*
    registries: {}
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
        diskQuotaSupport: true
    time:
        servers:
            - 192.168.4.1
    files:
        - content: ENC[AES256_GCM,data:d6/S29b9BHCzAmAD0FfF+l9AxOdwSTCy0gBiYasXq3MCMjhm+DBh7SXhoAJiwmnEkFZ49pNN1v+bDyvFMdsB/sFaEF/EtZ7BNLGYBZD5tBRc/183At1B5IU1Dmfnjy736Coy5Xdl7MVijTMbtF+bH/yQFQG+RuzvkZm6UwRUcNrb1pvrbTzlieOkK9DsqTwpUsPv8j+nXMd7RNDstTzPUbGMdIfuzHYvzC5OJ+icMw==,iv:5sD8mEJONfT6AK/+WcZyTBD2d4yswmApK/J5AeqCYqg=,tag:vuZJqzzrQr5urNt7fY/nqw==,type:str]
          permissions: 420
          path: /var/etc/tailscale/auth.env
          op: create
cluster:
    id: ENC[AES256_GCM,data:wP4i8UNrsI7InVgQdW8vYbv5BREw4Sg6jR/6dNl3BiW2qd4Bh8EHz98NK2g=,iv:jX/TuJo1LQ6eLkvhe7IR/GxM9VUU8XGBerDyfAlmqlE=,tag:d4baFsmEeQf/dBehv1alwQ==,type:str]
    secret: ENC[AES256_GCM,data:A/w8rpAcSEYaWlpAdYlhBaf2hfH8UXE8IyAXwYevjqDpuXGqM1JMkjyJz6Y=,iv:KnPR0XZ/lEZfPZL7waqoqVnPnj/mMMi/wIMHrbocbJg=,tag:Ps9LfIdTk/t0smuJ62lvoQ==,type:str]
    controlPlane:
        endpoint: https://talos.s3rv.dev:6443
    clusterName: talos-proxmox
    network:
        dnsDomain: talos.s3rv.dev
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    token: ENC[AES256_GCM,data:WpA3uw7TJP3fRxPxv16rtMV2/BYvmbI=,iv:G9nSR2lg58WUqedo59nN7TeyziSVsCg39ZHuvI1FWfI=,tag:7/toUiZV61ulm+T7TW7IbA==,type:str]
    secretboxEncryptionSecret: ENC[AES256_GCM,data:UlwQqWgnUoXerBxyuuy2GWbu3ftgi2paPaJseW8K+v0/TdH/oRalMUw84nE=,iv:9IPBHfRd6sO5l/woLoxZc6NnuVwKfEY2d5OvdnhM/Rs=,tag:WGVLTc95wbGxB9GK1+YZiQ==,type:str]
    ca:
        crt: ENC[AES256_GCM,data:vkKnuXuhsLlmkGVb96LoOUSOlbSiIARTlal7GmdevpMG5EP4hyHhQzX1RL5ajPwFqzPRE/oFF/SxWASQMP1A5fFOQDde39eUx5kAPHKKUmQPA8FbxMorllELIaZZxX8TsAuKsBM/mB6RIzgxIlTaUdjJ6BCsZqGB/CCB+ZDOnCChjlDgJCMHKrjRYdlwr1MWzY4M976LFdxsk8YiHDV519QicirmSk8BBGl06wAbdiJHJ1NK1lwPUDe2Q+TLVNvYqEa2dOB7jooQYcdkwhNMq3kBZqbTS3ohc3d/xCNqat5dAG+7mE4DXj5k+tFTOVdHj0sGhEd9/RlotasWVCA6r6vKeyF/mB0+c1gUkR96yCyTAM9Zk8ATgKxqfA2BGqN4U1ymxpjZWhDi6svjhSeh8ck96D+H5+QmIQZnfIzeRWAqEllyrOGCRlPMyb/1yzkKVfVyPJb/NfMyIQRGkQYfgRCROvtfnBiYGDkkubt282TnPZrJvgU53MNhyUN/5Lf2wFo2mM4d1Zhj1zX3Q280My+6MCAjGm7yvsRzBS26T2h/v5/dlbhuLBk66Kr4QoUMOmdlGnconEQUjTyKG2wMHFh3L1Ol+Fp4kkV7g+aSQnDd/uzG8d00KFjqyPtsMKmejsGVpnKdRMfMAmuGxjaOVn8jRbzXIRudrug1cixTRkkgrKGlYV+lYdsr0rSrg5d05ugDdRvwOZpDso9XifkSq3wqABDQa6HtRPhJ7ALYDYulxACK2xDNLl8tBpAg1KL6eq3S413W3pmykALcfcBnKi2l+BSL/MzKADZC3KnHOj6ql7OT502fzKoe702r7oC32CoIPHx6Mm/GOeVFsmXLUwg/hFK0tqsuYkypNxoqdOaiiSvH1jkBwY3nG6YDzmfVRzzxYXNEm4GMXLZFRSS5R8K3ahVXswRiAxghObdbbG/fY4j3gPV5pPUwGOdpqPlp4yVVeWtDxGe9YlIxgHKqPqeWP4UYTwbYur07YkO9zTmNPRJJ7RWLaot6o+/ul7Q/+D0PLBRH9yXX5TwFwAz0XVfGBAEaGBGEtaJlBw==,iv:CsN6IqzEmEVNW1DHqoVn7kGRDh4y+m5RD9XwtzjB/HI=,tag:gv1JmipGY0I7vChVh3ff0w==,type:str]
        key: ENC[AES256_GCM,data:Qj3NWMyCGCzDo6tzoEa9bRsMMHv2wwJ+N4Dyg8UmBbP+FakkuhGiYV+l/UA8nZpj1jeAMhfHYRfH2c/dgGfWdjhvhIH5gqQwoFZsMRPN1ZAJvhC17u9HCMVv9g9EmNpOhlyxEfu46o1eY5oycCvjZn0pTzxueOdzCNsLltIZuk/SZUM5WyPmXNf/BZ34D9wzgaAzlDqFC3FyqAyuw5SpCZnfRcHnZohLM/bPv8FAD4lI4/JrKuO3dco72q97kazfwq/hjEt783yiEZTDqd7bGgGFjtB6dJBgGpliMMg98ViTIZem+AHW60DPKnHmRFu5aIdUlp8/7bDskQBITxvB7YxTWF8hULEiAq9y3mibWVhPuGktkIaJhednZrsln0aRafOE5FwFa+XBoX2lPH1q3g==,iv:nN0Df0zhaoOoMxGsLBWFFwVEecHnwuWV5kFLlb49dnU=,tag:qgvdICI+gOI25ADacvE/0Q==,type:str]
    aggregatorCA:
        crt: ENC[AES256_GCM,data:ysuosXv/GY/5p77MDXYkX9IEGuLt+Zr7tD3Kh8BAnAnsW3kM7rztg2V+IAkbJ2wOS9Ei3RsrmKssZ07h8spf3KM64EJyR8ss9x4ssXBqasGpEdOVuMU7vrrf/9I0fqPXoeSgl6JII9EBL0Z0u57xmXCJ/0CChoyKhkdNS7luxrjvLfzu31DZRZvlHH2aIInwGECy3sIXpfz+bFSHaiBktq4gNRxrpF5+UchjmvKupb4dBMCNeHQOCGG8JR9ZBvMQOaT/aD+o3lSOAbuPNpXqbEZt9+zA6lfhUDUWICnvHJSzWVZ/oTd3qZrzcJUrjLBilGqgOGf9LaMHkmozo6M3cBkDlJEAWyihwnag9Wros3I2KSTOZ7UWXCHwmmN2QcTBqPRjP+b5QzEIkOGOwFn1g3mmp1ZhytuNG1sQRsDeUm4pfPyT4gpc0S1PaPxHoS2DAMZZD0IMfyJjecLiv8QCshjWwa70O4w5Ks5Po45JnCszpKZZXhf/l1AU2mTupFMH4Absvygmbchksqg1VPhJvG8gfJResMZr0GhktQQY18oXK95Gze1amz8lpxOESSdKEy4W/cK2UwPZF+BBoplVbYMIrMORP75aZ75x3pzOEiWiuPqxT9DtNflbFqKzDnFbewgVsr5k4+vtA8UnS0laNcTaPjC/IjxlCb9/MX+PhSbgkcX7CvdN5KJFtpp8+CdJOFOGW+2fSJnHozu0ZtnKVb88ZnNm9Vyo/TfzLbhYf0tHNyf1hcHdp1CzrB99WvHIdDY1SOpt3EPFwn/uo1hiESDVLeycARL5bo+Wq44s2ClOreZFvWQfKqfvt8HWoRO82mfQ+omfuya3jgDOoTYx+P/Yoskuw8hpKMNGtlVoE+Nw1aCbRgOdAEMHfbxvtPJe7aKsJjntX6C+abFKwK9tA3n87B18xSztdHhJ96tFMNggT4r3PaN5qLeMMJfsWj0j,iv:QisBPb0yM2tm6xbVG78rZ8CkBio1fgrQWp9n9L70oU0=,tag:bsWgyeb5f4/Y70aWh7IWgw==,type:str]
        key: ENC[AES256_GCM,data:drk7NjkkGSgefkUVna8KuYcYL4E9uSYtslnG22VtPo/kCt3Mb6GQGcRKCpplreMDQuvCU3S5Ztl0WFb3pYQqBg6bFK5rjSjZhqGWVuH3bTtFen1WC4taZeLD1B2uvB/eO/IB6fJeR81pNTnKvIBmULrimpJ3jRLZSPnIdyWf7ZqH/SVR03R+lAVnrJ3uMxlct1tnULTWmm9N/mnsgFOi1vVAP1ohPimxAmqIXYsyGisHUvc0dSCTVuTA35jokBxhnotBXdx58OElELPVUSh/jY/kyYuMQHZ0Bem9IzlU1ji8prcnhjIbRhKT/+HYXNbQPBUdRF5onn7zDGamzQk5LMFnrbuh3nfiBnkWFy0CUmKGDeIhyPQzf+T+43uBZAcbuSULv8Pw2rx1MtLyzzNXkw==,iv:FWBHNE3gZkLRIfIMr5um3Eg7bTp6su5h1sLz6nqB0lU=,tag:9gIPK1j/bNG42iavZkfW3Q==,type:str]
    serviceAccount:
        key: ENC[AES256_GCM,data:sWp5AXGhntojhASSZmOIHgZqAN1EZwYjICouT13MrKAwwz8CwdDzXPK7GmwXU1+82nfK0XnyCr6IbHRA6QA0adzLDONlqMl0/cNAnUZOk3h5Ye31zrJoLtmvNpkcFnl05UJ/C4ZPeMxE7kJ+nf4nHf+Wo1CyIeSk9gihT2U53nv2oCXHzHnNOK6L2jNFRL0SdbQYjKqNuSk4tNmVgV69lEcq9pHFdErLOFnfgaF4fCig20uqh/c458fxaoU1JAzzz1VOL/07IVIU0WayPypbf3MrrPBGN1HDe+uS3SgwFVBBt6rjASQ8b8juQ7HEzphWfTBwYmBt6z8fmMjWQKXOtXLYXWUsB45606suZ8FS5b4iaJNYwlaMBj1ZLeusb7ukFHWKWRoz8mYWD68Slbqgow==,iv:RYKrlqDfWS5f0jPc4bZDupxk7GMtm3j8xW/clsv81p8=,tag:MKnyPg69hc5SBDEoor8b7A==,type:str]
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.29.0
        certSANs:
            - 192.168.4.5
            - talos.s3rv.dev
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                defaults:
                    audit: baseline
                    audit-version: latest
                    enforce: baseline
                    enforce-version: latest
                    warn: baseline
                    warn-version: latest
                exemptions:
                    namespaces:
                        - kube-system
                    runtimeClasses: []
                    usernames: []
                kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: None
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.29.0
    proxy:
        image: registry.k8s.io/kube-proxy:v1.29.0
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.29.0
    discovery:
        enabled: true
        registries:
            kubernetes:
                disabled: true
            service: {}
    etcd:
        ca:
            crt: ENC[AES256_GCM,data:QsaWeTDH8bWNnLtSSNgUTSBWtxvXykMUsZUcC9Ybbk7KoDgzaNWREoHcUyLs17E00ZPZytmXmdSLBQ6S8T49t9MhLq7FRx0N+eDTxNAusJC46/FaaRuvTzx0PrtZaKWH1XnwKfuOsKDLVrAyiDMzINwf2F9ReOzuvo8pOhSnNU2AsYDGL5hm8QJoswFBcVURkZaehUi6dI/uDuna3x6iXeL/UJCdwLtd4jIwHuxn5oMtzdN5UBGo1T2UpOPQmGUTvIN2kSxFbcv+8W2Zkka+UU2RrQh3v+Tn0c1jBcKYJpKJwocaoNSsLw1RY7ykwC9562x9ehyk4eOWO734AEwZhdB9e7qpvRT8bc/G3f/nYBfeMnr+yVlO5GPaKyqtrAywVq0uBmZd+QEnH8EP1MHIkPqpWuj+vCrt0CH6J98LPsy2KsXCNfNqd87DWnP5vymMVY4/AbVNtv/YTTZICRUFJ7s4vFS1jeWWGfZK1UcVO+cUvYaM8rk0gqsDLl3yOAuqgFR4Y/ZRM99GoJO+uJCj72qmApEiGJ1nFAUpM5LhQ4GBVJg2gS60jgzAY/BRUN4MIMQV27bm2WYpmJCFBuAgtj6f6KyojyWaXACof7MjNl7rvvGGvWYXK3TPbFJSUzsNlH+0uWVc7qzE4vIi5kVeS2IjO7p1jpkKTiXoTm3d158HeTIIHDcpi04GXNEFI+Ka5WgMQbIBZyh18iP/LayXt5s1Ja/a1trzfENuEvYMX36+Ts1PpGGwQn4nfmuUkhT0gKgGiuYSN4LTy3qzrQW2FM/NApSTtF4/FitOigPWWLIjzXXnLx+M4/HA//Pi0IMLtatkqRfHbuhFr++aKPvWNuqRoFvezXH4BZ4cxPYFujjsttEldtlDBzKHLiMzwfKEws7Bdxl4DBZyq7AdswRvcDrxyqntNMQtREMKl5wbzX2NsmxGWMer/83g1NrMmG8QQ+Fbziy8awt+VJiuZjMf+Kgy/voKkonVSsLNHAKP55T7zW8bivfS5tZB8ldS7d2TFOvr6w==,iv:M+1bcXOf1ReLC4NK7VCTs0/DD8hLKVUBP8d8eX5GWl4=,tag:Wpho54+C9KBYyUvGfY7zWg==,type:str]
            key: ENC[AES256_GCM,data:OCl86LvP8/YCbz6ziRE2M2L5DUH3aK1Lgz2W/d1PMoDJp67dKRkdQz7gzu+8qP56UzBA2ysw3Y7V/I6Tut29Uw9Quzf1cs8K6KQq96nEdzru0+BNmx1iWXjLPM3lodEHoRkonr1lcuBEoTzwhtDew8bqpZpMS1thDKZwSzvezWNeRvCDASme2Amv6PS9lpVtYZJeh88oi6pK7uZLhVdYPSUTfTvvQarqFXiqBRj93vuNlMASmIuRr1Gz4kfrMLxWcd7YJfmFs2t8+5KUhoKmfUPgsqFx77UeAipLwZo5dnOHZvRGRJTcqq2iKyE1tSdHrQHGDDzt11kb29TeVVAEHquPwIPnzh1WnQYWB1lnEsSnGVxla7DCaX6QuwgSZJs7Krm+nRU47uSvVYHZjYGGxw==,iv:wB7NXEe8xJeCkuS8JoyDwQpQfdGZBuANlBXMpUHbKik=,tag:mN2PFQgmwYNaIewhmj//Fg==,type:str]
    extraManifests:
        - https://raw.githubusercontent.com/alex1989hu/kubelet-serving-cert-approver/main/deploy/standalone-install.yaml
        - https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
    allowSchedulingOnControlPlanes: false
sops:
    kms: []
    gcp_kms: []
    azure_kv: []
    hc_vault: []
    age:
        - recipient: age1xjszg77q3ddquyvgh7scmwh27hk4ns0uef5w4y5feq2nnc0v8y4smgdan7
          enc: |
            -----BEGIN AGE ENCRYPTED FILE-----
            YWdlLWVuY3J5cHRpb24ub3JnL3YxCi0+IFgyNTUxOSBnQmU2T25HR0R0OUtzcmVx
            RmlEUUhEVERHWHZodTRpa0tBWFB0d3dqYkI0CldGMmNkaVFGakk5ZUhUTlBsaHVI
            VStQNXpEOEdBSnE3enpjdjR5TlRHR1EKLS0tIGxtZFZQZ2lMSEFObkpqdFplSnRq
            aitzQy9UYzNkU3pOaDA4NUU5VTR2V3cK841V2u7FI0+WXlSoxX7PuzJCWdGqXQW6
            Zkc512pdDgt4bpSe+d3vbjXi0TiXRnbdG5/NBIUggXLpcxNCh/OmCw==
            -----END AGE ENCRYPTED FILE-----
    lastmodified: "2024-02-04T17:28:46Z"
    mac: ENC[AES256_GCM,data:04xCE3EOqVY/Z4XVrmeZ+4SXf0rV37+v6krvEfuDE9Mnw8cFmvgDT9LCMpUL9KQokMp0bKlTyGNVR54A3FXz/+B5smlxY1HmVt5Elq6uOjucjz0yQGpZM/bSRHrTesS5cM8cLR9xI/uQFgWlQXZmCjuM6Qo9/3Oe3ZiTj1aJSDA=,iv:U5MQWW+tqzxFF4Jpg/E6k5FjTgHEUATxTQaFBGkgngI=,tag:lC2z1bk9QfWRl6oPiiLyGg==,type:str]
    pgp: []
    encrypted_regex: ^(content|tls.crt|tls.key|crt|key|secret|secretboxEncryptionSecret|token|id|ca|data)$
    version: 3.8.1
